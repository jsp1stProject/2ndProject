<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sist.web.chat.group.mapper.GroupChatMapper">
	<select id="selectLatestMessageByGroupId" resultType="com.sist.web.chat.group.vo.GroupChatVO" parameterType="hashmap">
		SELECT * FROM group_msg 
		WHERE group_no = #{group_id} 
		<if test="last_message_no != null">
			AND message_no &lt; #{last_message_no}
		</if>
		ORDER BY message_id DESC
		FETCH FIRST 20 ROWS ONLY
	</select>
	<insert id="insertGroupMember" parameterType="com.sist.web.chat.group.vo.GroupMemberVO">
		INSERT INTO p_group_member (group_no, user_no
		    <if test="role != null and role != ''">
		        , role
		    </if>
	    )
	    VALUES
	    (#{group_no}, #{user_no}
	    <if test="role != null and role != ''">
	        , #{role}
	    </if>
	    )
	</insert>
</mapper>